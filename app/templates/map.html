{% extends "base.html" %}
{% block head_scripts %}

        <!--  Leaflet.draw-master  -->
        <script src="/static/leaflet.js"></script>
        <link rel="stylesheet" href="/static/leaflet.css" />

        <!-- D3 and JQuery -->
        <script src="/static/js/jquery-1.11.0.js"></script>  <!-- | JQUERY -->
        <!-- <script src="/static/js/jquery-ui-1.11.4.js"></script> -->  <!-- JQUERY UI -->
        <script src = "/static/js/d3.js"></script>

        <!-- Font Awesome CSS -->
        <link rel="stylesheet" href="/static/font-awesome-4.3.0/css/font-awesome.min.css">

        <!-- Main style -->
        <link rel="stylesheet" href="/static/mapClient.css" />       

{% endblock %}
{% block content %}

        {% csrf_token %}

        <div class="container-fluid">
            <div class="row">
                <div id='map'> </div>
            </div>



  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 style="color:red;"><span class="glyphicon glyphicon-lock"></span> Login</h4>
        </div>
        <div class="modal-body">
          <form role="form">
            <div class="form-group">
              <label for="usrname"><span class="glyphicon glyphicon-user"></span> Username</label>
              <input type="text" class="form-control" id="usrname" placeholder="Enter email">
            </div>
            <div class="form-group">
              <label for="psw"><span class="glyphicon glyphicon-eye-open"></span> Password</label>
              <input type="text" class="form-control" id="psw" placeholder="Enter password">
            </div>
            <div class="checkbox">
              <label><input type="checkbox" value="" checked>Remember me</label>
            </div>
            <button type="submit" class="btn btn-default btn-success btn-block"><span class="glyphicon glyphicon-off"></span> Login</button>
          </form>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
          <p>Not a member? <a href="#">Sign Up</a></p>
          <p>Forgot <a href="#">Password?</a></p>
        </div>
      </div>
    </div>
  </div> 



        </div>

        <script>

            // var username = "{{ username|safe }}";

            var map;
            
            var marker = L.marker()
                .on("click", function(e){
                    $("#myModal").modal('show'); //hide 
                });

            $(function(){

                map = L.map('map', {maxZoom: 23});

                L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png',{ 
                    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
                }).addTo(map);

                map.setView( [0,0], 1 );

                map.on("click", function(e){
                    marker.setLatLng(e.latlng);
                    if (!marker.hasOwnProperty("_map")) {
                        marker.addTo(map);
                    }
                });

            });




 
    function sendZoneInfo(){
        var payload = {
            uuid: "zone1",
            outlets_used: 5,
            csrfmiddlewaretoken: '{{ csrf_token|safe }}'
        }
        $.ajax({
            type: "POST",
            async: true,
            data:  JSON.stringify(payload),
            url: "/api/v1/zone",
            dataType: 'JSON',
            success: function (data) {
                console.log(data)
            },
            error: function(xhr,errmsg,err) {
                throw new Error(errmsg);
            }
        });



}

        </script>

{% endblock %}

